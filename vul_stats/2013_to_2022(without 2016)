72844
[('CWE-79', 16617), ('CWE-787', 7314), ('CWE-119', 6550), ('CWE-20', 6133), ('CWE-89', 5404), ('CWE-200', 4738), ('CWE-125', 4699), ('CWE-22', 3387), ('CWE-352', 3250), ('NVD-CWE-Other', 3188), ('CWE-416', 3087), ('CWE-78', 2387), ('CWE-287', 2069), ('CWE-264', 2017), ('CWE-310', 2004), ('CWE-476', 1873), ('CWE-190', 1837), ('CWE-434', 1486), ('CWE-269', 1478), ('CWE-120', 1441), ('CWE-862', 1307), ('CWE-863', 1254), ('CWE-94', 1174), ('CWE-77', 1164), ('CWE-400', 1096), ('CWE-732', 1051), ('CWE-399', 940), ('CWE-502', 920), ('CWE-798', 920), ('CWE-74', 879), ('CWE-362', 823), ('CWE-522', 813), ('CWE-276', 794), ('CWE-611', 782), ('CWE-295', 778), ('CWE-306', 753), ('CWE-918', 740), ('CWE-601', 670), ('CWE-668', 648), ('CWE-59', 568), ('CWE-770', 524), ('CWE-284', 489), ('CWE-427', 486), ('CWE-401', 485), ('CWE-835', 478), ('CWE-532', 465), ('CWE-319', 424), ('CWE-772', 383), ('CWE-617', 370), ('CWE-426', 370), ('CWE-189', 367), ('CWE-843', 362), ('CWE-415', 357), ('CWE-312', 349), ('CWE-203', 338), ('CWE-327', 334), ('CWE-755', 331), ('CWE-639', 313), ('CWE-347', 297), ('CWE-255', 291), ('CWE-129', 287), ('CWE-908', 263), ('CWE-121', 262), ('CWE-326', 261), ('CWE-345', 254), ('CWE-369', 241), ('CWE-1321', 223), ('CWE-209', 221), ('CWE-754', 221), ('CWE-307', 217), ('CWE-384', 216), ('CWE-613', 214), ('CWE-1021', 208), ('CWE-665', 208), ('CWE-330', 203), ('CWE-254', 192), ('CWE-311', 192), ('CWE-674', 185), ('CWE-552', 182), ('CWE-346', 176), ('CWE-704', 175), ('CWE-444', 174), ('CWE-404', 168), ('CWE-367', 165), ('CWE-17', 161), ('CWE-1236', 158), ('CWE-19', 152), ('CWE-191', 149), ('CWE-290', 147), ('CWE-917', 141), ('CWE-122', 141), ('CWE-824', 138), ('CWE-88', 138), ('CWE-281', 136), ('CWE-428', 134), ('CWE-521', 133), ('CWE-134', 132), ('CWE-1188', 130), ('CWE-610', 120), ('CWE-116', 115), ('CWE-640', 112), ('CWE-667', 111), ('CWE-425', 108), ('CWE-922', 96), ('CWE-294', 94), ('CWE-682', 85), ('CWE-494', 82), ('CWE-829', 80), ('CWE-131', 75), ('CWE-707', 75), ('CWE-354', 74), ('CWE-459', 74), ('CWE-909', 70), ('CWE-252', 69), ('CWE-91', 68), ('CWE-697', 65), ('CWE-338', 63), ('CWE-681', 63), ('CWE-834', 62), ('CWE-916', 58), ('CWE-693', 58), ('CWE-193', 54), ('CWE-763', 51), ('CWE-285', 51), ('CWE-706', 45), ('CWE-670', 44), ('CWE-331', 43), ('CWE-776', 41), ('CWE-662', 40), ('CWE-436', 37), ('CWE-788', 36), ('CWE-275', 35), ('CWE-669', 35), ('CWE-212', 34), ('CWE-93', 33), ('CWE-1333', 30), ('CWE-565', 29), ('CWE-913', 28), ('CWE-320', 26), ('CWE-388', 21), ('CWE-16', 21), ('CWE-266', 20), ('CWE-672', 19), ('CWE-358', 18), ('CWE-256', 17), ('CWE-335', 17), ('CWE-113', 16), ('CWE-123', 15), ('CWE-288', 15), ('CWE-417', 15), ('CWE-80', 15), ('CWE-23', 15), ('CWE-178', 15), ('CWE-273', 15), ('CWE-377', 14), ('CWE-185', 13), ('CWE-126', 12), ('CWE-822', 12), ('CWE-118', 12), ('CWE-321', 12), ('CWE-470', 11), ('CWE-250', 11), ('CWE-73', 11), ('CWE-924', 10), ('CWE-379', 10), ('CWE-749', 9), ('CWE-538', 9), ('CWE-297', 9), ('CWE-838', 9), ('CWE-680', 8), ('CWE-61', 8), ('CWE-359', 8), ('CWE-184', 8), ('CWE-789', 8), ('CWE-332', 8), ('CWE-305', 7), ('CWE-90', 7), ('CWE-472', 7), ('CWE-99', 6), ('CWE-201', 6), ('CWE-441', 6), ('CWE-489', 6), ('CWE-457', 6), ('CWE-248', 6), ('CWE-1220', 6), ('CWE-170', 6), ('CWE-799', 6), ('CWE-117', 6), ('CWE-823', 5), ('CWE-18', 5), ('CWE-471', 5), ('CWE-208', 5), ('CWE-1284', 5), ('CWE-322', 5), ('CWE-912', 5), ('CWE-259', 5), ('CWE-548', 5), ('CWE-172', 5), ('CWE-840', 4), ('CWE-940', 4), ('CWE-199', 4), ('CWE-406', 4), ('CWE-204', 3), ('CWE-115', 3), ('CWE-300', 3), ('CWE-1187', 3), ('CWE-440', 3), ('CWE-620', 3), ('CWE-920', 3), ('CWE-805', 3), ('CWE-130', 3), ('CWE-497', 3), ('CWE-95', 3), ('CWE-353', 3), ('CWE-21', 3), ('CWE-648', 3), ('CWE-1336', 3), ('CWE-453', 2), ('CWE-385', 2), ('CWE-112', 2), ('CWE-807', 2), ('CWE-214', 2), ('CWE-124', 2), ('CWE-708', 2), ('CWE-202', 2), ('CWE-342', 2), ('CWE-350', 2), ('CWE-943', 2), ('CWE-279', 2), ('CWE-240', 2), ('CWE-303', 2), ('CWE-1274', 2), ('CWE-534', 2), ('CWE-405', 2), ('CWE-642', 2), ('CWE-318', 2), ('CWE-1258', 2), ('CWE-1286', 2), ('CWE-1022', 2), ('CWE-644', 2), ('CWE-328', 2), ('CWE-270', 2), ('CWE-349', 2), ('CWE-277', 2), ('CWE-407', 2), ('CWE-603', 2), ('CWE-280', 2), ('CWE-549', 2), ('CWE-194', 2), ('CWE-757', 2), ('CWE-75', 2), ('CWE-1287', 2), ('CWE-241', 2), ('CWE-769', 2), ('CWE-304', 2), ('CWE-1004', 2), ('CWE-302', 2), ('CWE-657', 2), ('CWE-1241', 2), ('CWE-778', 2), ('CWE-507', 1), ('CWE-146', 1), ('CWE-567', 1), ('CWE-774', 1), ('CWE-1390', 1), ('CWE-1320', 1), ('CWE-267', 1), ('CWE-36', 1), ('CWE-524', 1), ('CWE-527', 1), ('CWE-424', 1), ('CWE-364', 1), ('CWE-317', 1), ('CWE-274', 1), ('CWE-24', 1), ('CWE-455', 1), ('CWE-760', 1), ('CWE-460', 1), ('CWE-187', 1), ('CWE-282', 1), ('CWE-911', 1), ('CWE-1283', 1), ('CWE-98', 1), ('CWE-451', 1), ('CWE-540', 1), ('CWE-664', 1), ('CWE-791', 1), ('CWE-1329', 1), ('CWE-371', 1), ('CWE-391', 1), ('CWE-315', 1), ('CWE-228', 1), ('CWE-915', 1), ('CWE-334', 1), ('CWE-710', 1), ('CWE-271', 1), ('CWE-523', 1), ('CWE-597', 1), ('CWE-1288', 1), ('CWE-643', 1), ('CWE-573', 1), ('CWE-15', 1), ('CWE-229', 1), ('CWE-525', 1), ('CWE-141', 1), ('CWE-29', 1), ('CWE-598', 1), ('CWE-268', 1), ('CWE-602', 1), ('CWE-235', 1), ('CWE-378', 1), ('CWE-84', 1), ('CWE-27', 1), ('CWE-1278', 1), ('CWE-299', 1), ('CWE-325', 1), ('CWE-1108', 1), ('CWE-759', 1), ('CWE-923', 1), ('CWE-324', 1), ('CWE-216', 1), ('CWE-1282', 1), ('CWE-475', 1), ('CWE-690', 1), ('CWE-409', 1), ('CWE-361', 1), ('CWE-671', 1), ('CWE-684', 1), ('CWE-779', 1), ('CWE-456', 1), ('CWE-313', 1), ('CWE-941', 1), ('CWE-242', 1), ('CWE-539', 1), ('CWE-257', 1), ('CWE-435', 1), ('CWE-833', 1), ('CWE-64', 1), ('CWE-590', 1), ('CWE-1076', 1), ('CWE-895', 1), ('CWE-323', 1), ('CWE-114', 1), ('CWE-195', 1), ('CWE-506', 1), ('CWE-1026', 1)]
346
{'CWE-287', 'CWE-22', 'CWE-787', 'CWE-89', 'CWE-20', 'CWE-200', 'CWE-119', 'CWE-79', 'NVD-CWE-Other', 'CWE-310', 'CWE-416', 'CWE-78', 'CWE-352', 'CWE-125', 'CWE-264'}
15
72844
15
['CWE-119', 'CWE-125', 'CWE-20', 'CWE-200', 'CWE-22', 'CWE-264', 'CWE-287', 'CWE-310', 'CWE-352', 'CWE-416', 'CWE-78', 'CWE-787', 'CWE-79', 'CWE-89', 'NVD-CWE-Other']

vec_len = 100
min_count = 1
window_len = 5
# dense_unit = 128
dense_unit = 256
wv_model_path  = '..//..//models//wv//'+infix+"_"+str(vec_len)+"_"+str(min_count)+"_"+str(window_len)+'.pkl'
label_path = '..\\..\\data\\clean\\nvdcve-1.1-'+infix+'_labels.csv'
n=30

# cwe_count = 27  # 2020,2021
# cwe_count = 17  # 2020,2021_500
# cwe_count = 18  # 2020,2021,2022_700
# cwe_count = 17  # 2018,2019ï¼Œ2020,2021,2022_1300
cwe_count = 15

Epoch 1/10
2023-03-02 12:12:40.823571: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-03-02 12:12:41.197140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2023-03-02 12:12:41.878850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2023-03-02 12:12:41.903361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2023-03-02 12:12:43.447007: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2023-03-02 12:12:43.500489: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2023-03-02 12:12:43.627967: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
1822/1822 [==============================] - 103s 54ms/step - loss: 1.0226 - accuracy: 0.6716
2023-03-02 12:14:22.797436: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1398600000 exceeds 10% of free system memory.
Epoch 2/10
1822/1822 [==============================] - 98s 54ms/step - loss: 0.6300 - accuracy: 0.8015
2023-03-02 12:16:01.211759: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1398600000 exceeds 10% of free system memory.
Epoch 3/10
1822/1822 [==============================] - 163s 90ms/step - loss: 0.5629 - accuracy: 0.8207
Epoch 4/10
1822/1822 [==============================] - 100s 55ms/step - loss: 0.5050 - accuracy: 0.8384
Epoch 5/10
1822/1822 [==============================] - 100s 55ms/step - loss: 0.4572 - accuracy: 0.8502
Epoch 6/10
1822/1822 [==============================] - 99s 55ms/step - loss: 0.4165 - accuracy: 0.8628
Epoch 7/10
1822/1822 [==============================] - 117s 64ms/step - loss: 0.3862 - accuracy: 0.8714
Epoch 8/10
1822/1822 [==============================] - 100s 55ms/step - loss: 0.3632 - accuracy: 0.8787
Epoch 9/10
1822/1822 [==============================] - 100s 55ms/step - loss: 0.3493 - accuracy: 0.8829
Epoch 10/10
1822/1822 [==============================] - 100s 55ms/step - loss: 0.3339 - accuracy: 0.8902
456/456 [==============================] - 4s 8ms/step - loss: 0.7707 - accuracy: 0.8053
last score: [0.7707366347312927, 0.8052714467048645]
Model: "sequential"

vec_len = 200
1822/1822 [==============================] - 121s 63ms/step - loss: 1.0228 - accuracy: 0.6712
2023-03-02 14:09:18.982101: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 2797200000 exceeds 10% of free system memory.
Epoch 2/10
1822/1822 [==============================] - 236s 129ms/step - loss: 0.6288 - accuracy: 0.8002
2023-03-02 14:13:15.437399: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 2797200000 exceeds 10% of free system memory.
Epoch 3/10
1822/1822 [==============================] - 252s 138ms/step - loss: 0.5627 - accuracy: 0.8194
Epoch 4/10
1822/1822 [==============================] - 252s 138ms/step - loss: 0.5110 - accuracy: 0.8354
Epoch 5/10
1822/1822 [==============================] - 258s 142ms/step - loss: 0.4707 - accuracy: 0.8471
Epoch 6/10
1822/1822 [==============================] - 267s 146ms/step - loss: 0.4371 - accuracy: 0.8568
Epoch 7/10
1822/1822 [==============================] - 237s 130ms/step - loss: 0.4094 - accuracy: 0.8667
Epoch 8/10
1822/1822 [==============================] - 105s 58ms/step - loss: 0.3920 - accuracy: 0.8712
Epoch 9/10
1822/1822 [==============================] - 104s 57ms/step - loss: 0.3714 - accuracy: 0.8759
Epoch 10/10
1822/1822 [==============================] - 133s 73ms/step - loss: 0.3629 - accuracy: 0.8784
456/456 [==============================] - 6s 11ms/step - loss: 0.7184 - accuracy: 0.8098
last score: [0.7184360027313232, 0.8098016381263733]




