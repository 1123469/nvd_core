100063
cwe_min_count = 2000
[('NVD-CWE-Other', 27813), ('CWE-79', 20872), ('CWE-119', 11127), ('CWE-89', 8945), ('CWE-20', 8702), ('CWE-787', 7287), ('CWE-200', 6578), ('CWE-264', 5096), ('CWE-22', 4796), ('CWE-125', 4463), ('CWE-352', 3883), ('CWE-416', 3338), ('CWE-94', 2791), ('CWE-287', 2778), ('CWE-399', 2547), ('CWE-310', 2432), ('CWE-78', 2422), ('CWE-476', 2006), ('CWE-190', 1934), ('CWE-434', 1497), ('CWE-120', 1483), ('CWE-269', 1454), ('CWE-862', 1262), ('CWE-189', 1234), ('CWE-863', 1221), ('CWE-77', 1203), ('CWE-400', 1179), ('CWE-362', 1048), ('CWE-284', 1019), ('CWE-732', 1002), ('CWE-798', 926), ('CWE-59', 900), ('CWE-502', 875), ('CWE-611', 803), ('CWE-295', 797), ('CWE-522', 777), ('CWE-306', 745), ('CWE-918', 733), ('CWE-276', 717), ('CWE-74', 701), ('CWE-255', 697), ('CWE-601', 693), ('CWE-668', 647), ('CWE-770', 508), ('CWE-835', 483), ('CWE-532', 465), ('CWE-401', 459), ('CWE-427', 457), ('CWE-319', 422), ('CWE-254', 395), ('CWE-426', 390), ('CWE-772', 390), ('CWE-415', 374), ('CWE-617', 360), ('CWE-312', 350), ('CWE-327', 336), ('CWE-755', 334), ('CWE-203', 331), ('CWE-639', 305), ('CWE-347', 291), ('CWE-134', 289), ('CWE-843', 279), ('CWE-908', 278), ('CWE-326', 273), ('CWE-129', 253), ('CWE-369', 250), ('CWE-345', 244), ('CWE-16', 242), ('CWE-384', 229), ('CWE-19', 223), ('CWE-209', 222), ('CWE-1321', 220), ('CWE-665', 216), ('CWE-754', 211), ('CWE-1021', 209), ('CWE-613', 206), ('CWE-330', 204), ('CWE-307', 201), ('CWE-704', 199), ('CWE-311', 195), ('CWE-674', 183), ('CWE-346', 182), ('CWE-552', 177), ('CWE-121', 173), ('CWE-404', 171), ('CWE-17', 165), ('CWE-367', 164), ('CWE-191', 159), ('CWE-444', 156), ('CWE-1236', 154), ('CWE-290', 145), ('CWE-122', 142), ('CWE-917', 141), ('CWE-88', 139), ('CWE-281', 135), ('CWE-428', 133), ('CWE-521', 132), ('CWE-1188', 127), ('CWE-824', 124), ('CWE-116', 117), ('CWE-640', 117), ('CWE-610', 116), ('CWE-425', 99), ('CWE-922', 94), ('CWE-294', 93), ('CWE-667', 93), ('CWE-829', 80), ('CWE-285', 79), ('CWE-909', 76), ('CWE-707', 75), ('CWE-459', 75), ('CWE-494', 73), ('CWE-682', 72), ('CWE-91', 72), ('CWE-354', 70), ('CWE-338', 65), ('CWE-681', 65), ('CWE-193', 65), ('CWE-131', 64), ('CWE-252', 64), ('CWE-834', 63), ('CWE-697', 62), ('CWE-275', 60), ('CWE-916', 58), ('CWE-693', 52), ('CWE-763', 50), ('CWE-331', 46), ('CWE-706', 45), ('CWE-670', 43), ('CWE-662', 41), ('CWE-776', 40), ('CWE-669', 39), ('CWE-93', 39), ('CWE-320', 37), ('CWE-788', 36), ('CWE-436', 35), ('CWE-388', 35), ('CWE-212', 34), ('CWE-565', 31), ('CWE-1333', 28), ('CWE-913', 28), ('CWE-113', 22), ('CWE-358', 21), ('CWE-672', 19), ('CWE-335', 19), ('CWE-273', 18), ('CWE-266', 17), ('CWE-256', 17), ('CWE-377', 16), ('CWE-80', 15), ('CWE-417', 15), ('CWE-178', 15), ('CWE-123', 15), ('CWE-23', 15), ('CWE-288', 14), ('CWE-118', 13), ('CWE-185', 13), ('CWE-321', 12), ('CWE-126', 12), ('CWE-822', 12), ('CWE-73', 11), ('CWE-90', 11), ('CWE-470', 11), ('CWE-250', 11), ('CWE-379', 10), ('CWE-538', 10), ('CWE-924', 10), ('CWE-749', 10), ('CWE-297', 10), ('CWE-172', 9), ('CWE-332', 9), ('CWE-838', 9), ('CWE-184', 9), ('CWE-789', 8), ('CWE-680', 8), ('CWE-359', 8), ('CWE-472', 7), ('CWE-61', 7), ('CWE-99', 7), ('CWE-361', 7), ('CWE-305', 7), ('CWE-117', 6), ('CWE-441', 6), ('CWE-199', 6), ('CWE-248', 6), ('CWE-18', 6), ('CWE-201', 6), ('CWE-457', 6), ('CWE-799', 6), ('CWE-489', 6), ('CWE-170', 6), ('CWE-1284', 5), ('CWE-912', 5), ('CWE-471', 5), ('CWE-259', 5), ('CWE-208', 5), ('CWE-322', 5), ('CWE-548', 5), ('CWE-823', 5), ('CWE-840', 4), ('CWE-21', 4), ('CWE-406', 4), ('CWE-497', 3), ('CWE-805', 3), ('CWE-920', 3), ('CWE-353', 3), ('CWE-115', 3), ('CWE-130', 3), ('CWE-1187', 3), ('CWE-648', 3), ('CWE-440', 3), ('CWE-204', 3), ('CWE-300', 3), ('CWE-407', 3), ('CWE-1336', 3), ('CWE-95', 3), ('CWE-124', 2), ('CWE-75', 2), ('CWE-549', 2), ('CWE-940', 2), ('CWE-778', 2), ('CWE-1258', 2), ('CWE-280', 2), ('CWE-1286', 2), ('CWE-328', 2), ('CWE-241', 2), ('CWE-534', 2), ('CWE-1004', 2), ('CWE-1241', 2), ('CWE-279', 2), ('CWE-1220', 2), ('CWE-342', 2), ('CWE-214', 2), ('CWE-943', 2), ('CWE-302', 2), ('CWE-620', 2), ('CWE-318', 2), ('CWE-1022', 2), ('CWE-453', 2), ('CWE-664', 2), ('CWE-202', 2), ('CWE-303', 2), ('CWE-807', 2), ('CWE-657', 2), ('CWE-1274', 2), ('CWE-708', 2), ('CWE-270', 2), ('CWE-405', 2), ('CWE-1287', 2), ('CWE-304', 2), ('CWE-769', 2), ('CWE-240', 2), ('CWE-603', 2), ('CWE-194', 2), ('CWE-385', 2), ('CWE-349', 2), ('CWE-1', 2), ('CWE-642', 2), ('CWE-112', 2), ('CWE-757', 2), ('CWE-277', 2), ('CWE-644', 2), ('CWE-350', 2), ('CWE-911', 1), ('CWE-1278', 1), ('CWE-1026', 1), ('CWE-141', 1), ('CWE-242', 1), ('CWE-774', 1), ('CWE-1390', 1), ('CWE-506', 1), ('CWE-195', 1), ('CWE-597', 1), ('CWE-317', 1), ('CWE-475', 1), ('CWE-29', 1), ('CWE-24', 1), ('CWE-833', 1), ('CWE-187', 1), ('CWE-710', 1), ('CWE-1283', 1), ('CWE-229', 1), ('CWE-643', 1), ('CWE-271', 1), ('CWE-313', 1), ('CWE-146', 1), ('CWE-371', 1), ('CWE-216', 1), ('CWE-334', 1), ('CWE-364', 1), ('CWE-274', 1), ('CWE-649', 1), ('CWE-378', 1), ('CWE-257', 1), ('CWE-1320', 1), ('CWE-323', 1), ('CWE-525', 1), ('CWE-235', 1), ('CWE-324', 1), ('CWE-760', 1), ('CWE-573', 1), ('CWE-337', 1), ('CWE-456', 1), ('CWE-451', 1), ('CWE-15', 1), ('CWE-325', 1), ('CWE-527', 1), ('CWE-282', 1), ('CWE-299', 1), ('CWE-1076', 1), ('CWE-759', 1), ('CWE-671', 1), ('CWE-424', 1), ('CWE-567', 1), ('CWE-114', 1), ('CWE-539', 1), ('CWE-1329', 1), ('CWE-267', 1), ('CWE-895', 1), ('CWE-36', 1), ('CWE-435', 1), ('CWE-391', 1), ('CWE-228', 1), ('CWE-779', 1), ('CWE-915', 1), ('CWE-791', 1), ('CWE-590', 1), ('CWE-690', 1), ('CWE-602', 1), ('CWE-923', 1), ('CWE-315', 1), ('CWE-540', 1), ('CWE-268', 1), ('CWE-1282', 1), ('CWE-523', 1), ('CWE-775', 1), ('CWE-524', 1), ('CWE-1108', 1), ('CWE-684', 1), ('CWE-98', 1), ('CWE-941', 1), ('CWE-460', 1), ('CWE-455', 1), ('CWE-598', 1), ('CWE-84', 1), ('CWE-507', 1), ('CWE-64', 1), ('CWE-27', 1), ('CWE-409', 1), ('CWE-1288', 1)]
350
{'CWE-125', 'CWE-200', 'CWE-787', 'CWE-476', 'CWE-78', 'CWE-264', 'CWE-287', 'CWE-20', 'CWE-79', 'CWE-22', 'CWE-94', 'CWE-399', 'CWE-89', 'CWE-119', 'CWE-416', 'CWE-352', 'CWE-310'}
17
100063
17
['CWE-119', 'CWE-125', 'CWE-20', 'CWE-200', 'CWE-22', 'CWE-264', 'CWE-287', 'CWE-310', 'CWE-352', 'CWE-399', 'CWE-416', 'CWE-476', 'CWE-78', 'CWE-787', 'CWE-79', 'CWE-89', 'CWE-94']

vec_len = 100
min_count = 1
window_len = 5
dense_unit = 256
wv_model_path  = '..//..//models//wv//'+infix+"_"+str(vec_len)+"_"+str(min_count)+"_"+str(window_len)+'.pkl'
label_path = '..\\..\\data\\clean\\nvdcve-1.1-'+infix+'_labels.csv'
n=30

502/2502 [==============================] - 146s 56ms/step - loss: 0.8684 - accuracy: 0.7217
2023-03-04 09:17:20.797643: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1921200000 exceeds 10% of free system memory.
Epoch 2/10
2502/2502 [==============================] - 140s 56ms/step - loss: 0.5112 - accuracy: 0.8321
2023-03-04 09:19:41.569039: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1921200000 exceeds 10% of free system memory.
Epoch 3/10
2502/2502 [==============================] - 139s 56ms/step - loss: 0.4533 - accuracy: 0.8514
Epoch 4/10
2502/2502 [==============================] - 141s 56ms/step - loss: 0.4088 - accuracy: 0.8657
Epoch 5/10
2502/2502 [==============================] - 140s 56ms/step - loss: 0.3719 - accuracy: 0.8786
Epoch 6/10
2502/2502 [==============================] - 139s 56ms/step - loss: 0.3474 - accuracy: 0.8848
Epoch 7/10
2502/2502 [==============================] - 139s 56ms/step - loss: 0.3262 - accuracy: 0.8912
Epoch 8/10
2502/2502 [==============================] - 139s 56ms/step - loss: 0.3135 - accuracy: 0.8956
Epoch 9/10
2502/2502 [==============================] - 141s 56ms/step - loss: 0.3043 - accuracy: 0.8973
Epoch 10/10
2502/2502 [==============================] - 139s 56ms/step - loss: 0.2996 - accuracy: 0.9000
626/626 [==============================] - 6s 10ms/step - loss: 0.5624 - accuracy: 0.8371
last score: [0.5623908638954163, 0.8371058702468872]

vec_len = 200
min_count = 1
window_len = 5
dense_unit = 256
wv_model_path  = '..//..//models//wv//'+infix+"_"+str(vec_len)+"_"+str(min_count)+"_"+str(window_len)+'.pkl'
label_path = '..\\..\\data\\clean\\nvdcve-1.1-'+infix+'_labels.csv'
n=30

Epoch 1/10
2023-03-04 09:44:50.032727: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-03-04 09:44:50.569790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublas64_11.dll
2023-03-04 09:44:51.936597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cublasLt64_11.dll
2023-03-04 09:44:51.957919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudnn64_8.dll
2023-03-04 09:44:54.763476: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2023-03-04 09:44:54.815065: I tensorflow/core/platform/windows/subprocess.cc:308] SubProcess ended with return code: 0

2023-03-04 09:44:55.001030: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2502/2502 [==============================] - 151s 57ms/step - loss: 0.8623 - accuracy: 0.7245
2023-03-04 09:47:19.110695: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 3842400000 exceeds 10% of free system memory.
Epoch 2/10
2502/2502 [==============================] - 143s 57ms/step - loss: 0.5092 - accuracy: 0.8357
2023-03-04 09:49:42.914608: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 3842400000 exceeds 10% of free system memory.
Epoch 3/10
2502/2502 [==============================] - 144s 58ms/step - loss: 0.4534 - accuracy: 0.8536
Epoch 4/10
2502/2502 [==============================] - 145s 58ms/step - loss: 0.4144 - accuracy: 0.8639
Epoch 5/10
2502/2502 [==============================] - 145s 58ms/step - loss: 0.3862 - accuracy: 0.8707
Epoch 6/10
2502/2502 [==============================] - 144s 58ms/step - loss: 0.3662 - accuracy: 0.8799
Epoch 7/10
2502/2502 [==============================] - 145s 58ms/step - loss: 0.3515 - accuracy: 0.8820
Epoch 8/10
2502/2502 [==============================] - 137s 55ms/step - loss: 0.3369 - accuracy: 0.8889
Epoch 9/10
2502/2502 [==============================] - 136s 54ms/step - loss: 0.3298 - accuracy: 0.8895
Epoch 10/10
2502/2502 [==============================] - 137s 55ms/step - loss: 0.3300 - accuracy: 0.8903
626/626 [==============================] - 5s 8ms/step - loss: 0.5411 - accuracy: 0.8372
last score: [0.5411231517791748, 0.837155818939209]

93203
[('NVD-CWE-Other', 27813), ('CWE-79', 20872), ('CWE-119', 11127), ('CWE-89', 8945), ('CWE-20', 8702), ('CWE-787', 7287), ('CWE-200', 6578), ('CWE-264', 5096), ('CWE-22', 4796), ('CWE-125', 4463), ('CWE-352', 3883), ('CWE-416', 3338), ('CWE-94', 2791), ('CWE-287', 2778), ('CWE-399', 2547), ('CWE-310', 2432), ('CWE-78', 2422), ('CWE-476', 2006), ('CWE-190', 1934), ('CWE-434', 1497), ('CWE-120', 1483), ('CWE-269', 1454), ('CWE-862', 1262), ('CWE-189', 1234), ('CWE-863', 1221), ('CWE-77', 1203), ('CWE-400', 1179), ('CWE-362', 1048), ('CWE-284', 1019), ('CWE-732', 1002), ('CWE-798', 926), ('CWE-59', 900), ('CWE-502', 875), ('CWE-611', 803), ('CWE-295', 797), ('CWE-522', 777), ('CWE-306', 745), ('CWE-918', 733), ('CWE-276', 717), ('CWE-74', 701), ('CWE-255', 697), ('CWE-601', 693), ('CWE-668', 647), ('CWE-770', 508), ('CWE-835', 483), ('CWE-532', 465), ('CWE-401', 459), ('CWE-427', 457), ('CWE-319', 422), ('CWE-254', 395), ('CWE-426', 390), ('CWE-772', 390), ('CWE-415', 374), ('CWE-617', 360), ('CWE-312', 350), ('CWE-327', 336), ('CWE-755', 334), ('CWE-203', 331), ('CWE-639', 305), ('CWE-347', 291), ('CWE-134', 289), ('CWE-843', 279), ('CWE-908', 278), ('CWE-326', 273), ('CWE-129', 253), ('CWE-369', 250), ('CWE-345', 244), ('CWE-16', 242), ('CWE-384', 229), ('CWE-19', 223), ('CWE-209', 222), ('CWE-1321', 220), ('CWE-665', 216), ('CWE-754', 211), ('CWE-1021', 209), ('CWE-613', 206), ('CWE-330', 204), ('CWE-307', 201), ('CWE-704', 199), ('CWE-311', 195), ('CWE-674', 183), ('CWE-346', 182), ('CWE-552', 177), ('CWE-121', 173), ('CWE-404', 171), ('CWE-17', 165), ('CWE-367', 164), ('CWE-191', 159), ('CWE-444', 156), ('CWE-1236', 154), ('CWE-290', 145), ('CWE-122', 142), ('CWE-917', 141), ('CWE-88', 139), ('CWE-281', 135), ('CWE-428', 133), ('CWE-521', 132), ('CWE-1188', 127), ('CWE-824', 124), ('CWE-640', 117), ('CWE-116', 117), ('CWE-610', 116), ('CWE-425', 99), ('CWE-922', 94), ('CWE-294', 93), ('CWE-667', 93), ('CWE-829', 80), ('CWE-285', 79), ('CWE-909', 76), ('CWE-459', 75), ('CWE-707', 75), ('CWE-494', 73), ('CWE-91', 72), ('CWE-682', 72), ('CWE-354', 70), ('CWE-193', 65), ('CWE-338', 65), ('CWE-681', 65), ('CWE-252', 64), ('CWE-131', 64), ('CWE-834', 63), ('CWE-697', 62), ('CWE-275', 60), ('CWE-916', 58), ('CWE-693', 52), ('CWE-763', 50), ('CWE-331', 46), ('CWE-706', 45), ('CWE-670', 43), ('CWE-662', 41), ('CWE-776', 40), ('CWE-93', 39), ('CWE-669', 39), ('CWE-320', 37), ('CWE-788', 36), ('CWE-436', 35), ('CWE-388', 35), ('CWE-212', 34), ('CWE-565', 31), ('CWE-1333', 28), ('CWE-913', 28), ('CWE-113', 22), ('CWE-358', 21), ('CWE-672', 19), ('CWE-335', 19), ('CWE-273', 18), ('CWE-266', 17), ('CWE-256', 17), ('CWE-377', 16), ('CWE-23', 15), ('CWE-123', 15), ('CWE-417', 15), ('CWE-80', 15), ('CWE-178', 15), ('CWE-288', 14), ('CWE-118', 13), ('CWE-185', 13), ('CWE-321', 12), ('CWE-126', 12), ('CWE-822', 12), ('CWE-470', 11), ('CWE-73', 11), ('CWE-250', 11), ('CWE-90', 11), ('CWE-924', 10), ('CWE-538', 10), ('CWE-379', 10), ('CWE-297', 10), ('CWE-749', 10), ('CWE-838', 9), ('CWE-332', 9), ('CWE-172', 9), ('CWE-184', 9), ('CWE-680', 8), ('CWE-359', 8), ('CWE-789', 8), ('CWE-99', 7), ('CWE-361', 7), ('CWE-472', 7), ('CWE-61', 7), ('CWE-305', 7), ('CWE-441', 6), ('CWE-170', 6), ('CWE-201', 6), ('CWE-199', 6), ('CWE-457', 6), ('CWE-799', 6), ('CWE-117', 6), ('CWE-248', 6), ('CWE-489', 6), ('CWE-18', 6), ('CWE-823', 5), ('CWE-912', 5), ('CWE-471', 5), ('CWE-208', 5), ('CWE-322', 5), ('CWE-259', 5), ('CWE-1284', 5), ('CWE-548', 5), ('CWE-406', 4), ('CWE-840', 4), ('CWE-21', 4), ('CWE-115', 3), ('CWE-300', 3), ('CWE-648', 3), ('CWE-920', 3), ('CWE-353', 3), ('CWE-1336', 3), ('CWE-440', 3), ('CWE-95', 3), ('CWE-407', 3), ('CWE-1187', 3), ('CWE-497', 3), ('CWE-204', 3), ('CWE-805', 3), ('CWE-130', 3), ('CWE-644', 2), ('CWE-1220', 2), ('CWE-1258', 2), ('CWE-708', 2), ('CWE-194', 2), ('CWE-318', 2), ('CWE-112', 2), ('CWE-302', 2), ('CWE-1274', 2), ('CWE-940', 2), ('CWE-943', 2), ('CWE-1022', 2), ('CWE-385', 2), ('CWE-405', 2), ('CWE-807', 2), ('CWE-778', 2), ('CWE-240', 2), ('CWE-349', 2), ('CWE-342', 2), ('CWE-124', 2), ('CWE-1004', 2), ('CWE-769', 2), ('CWE-279', 2), ('CWE-1287', 2), ('CWE-270', 2), ('CWE-277', 2), ('CWE-620', 2), ('CWE-1286', 2), ('CWE-642', 2), ('CWE-280', 2), ('CWE-350', 2), ('CWE-534', 2), ('CWE-328', 2), ('CWE-214', 2), ('CWE-657', 2), ('CWE-303', 2), ('CWE-1241', 2), ('CWE-202', 2), ('CWE-304', 2), ('CWE-757', 2), ('CWE-241', 2), ('CWE-664', 2), ('CWE-549', 2), ('CWE-1', 2), ('CWE-75', 2), ('CWE-453', 2), ('CWE-603', 2), ('CWE-911', 1), ('CWE-506', 1), ('CWE-195', 1), ('CWE-1076', 1), ('CWE-456', 1), ('CWE-315', 1), ('CWE-274', 1), ('CWE-671', 1), ('CWE-540', 1), ('CWE-323', 1), ('CWE-1288', 1), ('CWE-455', 1), ('CWE-527', 1), ('CWE-114', 1), ('CWE-424', 1), ('CWE-29', 1), ('CWE-27', 1), ('CWE-324', 1), ('CWE-475', 1), ('CWE-523', 1), ('CWE-573', 1), ('CWE-282', 1), ('CWE-409', 1), ('CWE-64', 1), ('CWE-684', 1), ('CWE-775', 1), ('CWE-690', 1), ('CWE-1108', 1), ('CWE-391', 1), ('CWE-317', 1), ('CWE-710', 1), ('CWE-325', 1), ('CWE-833', 1), ('CWE-313', 1), ('CWE-597', 1), ('CWE-791', 1), ('CWE-941', 1), ('CWE-15', 1), ('CWE-141', 1), ('CWE-1320', 1), ('CWE-334', 1), ('CWE-235', 1), ('CWE-602', 1), ('CWE-371', 1), ('CWE-84', 1), ('CWE-1026', 1), ('CWE-643', 1), ('CWE-228', 1), ('CWE-257', 1), ('CWE-24', 1), ('CWE-539', 1), ('CWE-187', 1), ('CWE-378', 1), ('CWE-216', 1), ('CWE-364', 1), ('CWE-1329', 1), ('CWE-1282', 1), ('CWE-146', 1), ('CWE-895', 1), ('CWE-229', 1), ('CWE-649', 1), ('CWE-590', 1), ('CWE-915', 1), ('CWE-36', 1), ('CWE-242', 1), ('CWE-98', 1), ('CWE-271', 1), ('CWE-1390', 1), ('CWE-337', 1), ('CWE-435', 1), ('CWE-299', 1), ('CWE-268', 1), ('CWE-460', 1), ('CWE-507', 1), ('CWE-451', 1), ('CWE-779', 1), ('CWE-525', 1), ('CWE-598', 1), ('CWE-774', 1), ('CWE-524', 1), ('CWE-267', 1), ('CWE-567', 1), ('CWE-923', 1), ('CWE-1278', 1), ('CWE-759', 1), ('CWE-1283', 1), ('CWE-760', 1)]
350
{'CWE-94', 'CWE-352', 'CWE-287', 'CWE-264', 'CWE-20', 'CWE-200', 'CWE-89', 'CWE-125', 'CWE-119', 'CWE-416', 'CWE-22', 'CWE-787', 'CWE-399', 'CWE-79'}
14
93203
14
['CWE-119', 'CWE-125', 'CWE-20', 'CWE-200', 'CWE-22', 'CWE-264', 'CWE-287', 'CWE-352', 'CWE-399', 'CWE-416', 'CWE-787', 'CWE-79', 'CWE-89', 'CWE-94']

cwe_min_count = 2500


infix+='_'+str(cwe_min_count)

vec_len = 300
min_count = 1
window_len = 5
# dense_unit = 128
dense_unit = 256
wv_model_path  = '..//..//models//wv//'+infix+"_"+str(vec_len)+"_"+str(min_count)+"_"+str(window_len)+'.pkl'
label_path = '..\\..\\data\\clean\\nvdcve-1.1-'+infix+'_labels.csv'
n=30

cwe_count = 14
 # 顺序模型
    model = Sequential()
    model.add(Conv1D(256, 3, padding='same', strides=1, activation='relu'))
    model.add(MaxPool1D(pool_size=2))
    model.add(GRU(256, return_sequences=True))
    model.add(GRU(256,dropout=0.5, recurrent_dropout=0.1))
    model.add(Dense(cwe_count,activation="softmax"))

2331/2331 [==============================] - 138s 56ms/step - loss: 0.8006 - accuracy: 0.7352
2023-03-04 10:45:08.993045: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 5368464000 exceeds 10% of free system memory.
Epoch 2/10
2331/2331 [==============================] - 131s 56ms/step - loss: 0.4799 - accuracy: 0.8424
2023-03-04 10:47:22.034324: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 5368464000 exceeds 10% of free system memory.
Epoch 3/10
2331/2331 [==============================] - 130s 56ms/step - loss: 0.4288 - accuracy: 0.8559
Epoch 4/10
2331/2331 [==============================] - 130s 56ms/step - loss: 0.3948 - accuracy: 0.8684
Epoch 5/10
2331/2331 [==============================] - 129s 56ms/step - loss: 0.3690 - accuracy: 0.8757
Epoch 6/10
2331/2331 [==============================] - 130s 56ms/step - loss: 0.3492 - accuracy: 0.8820
Epoch 7/10
2331/2331 [==============================] - 130s 56ms/step - loss: 0.3358 - accuracy: 0.8877
Epoch 8/10
2331/2331 [==============================] - 130s 56ms/step - loss: 0.3268 - accuracy: 0.8893
Epoch 9/10
2331/2331 [==============================] - 129s 55ms/step - loss: 0.3223 - accuracy: 0.8916
Epoch 10/10
2331/2331 [==============================] - 130s 56ms/step - loss: 0.3173 - accuracy: 0.8920
583/583 [==============================] - 5s 8ms/step - loss: 0.4926 - accuracy: 0.8485
last score: [0.49259141087532043, 0.848505973815918]
Model: "sequential"


85087
[('NVD-CWE-Other', 27813), ('CWE-79', 20872), ('CWE-119', 11127), ('CWE-89', 8945), ('CWE-20', 8702), ('CWE-787', 7287), ('CWE-200', 6578), ('CWE-264', 5096), ('CWE-22', 4796), ('CWE-125', 4463), ('CWE-352', 3883), ('CWE-416', 3338), ('CWE-94', 2791), ('CWE-287', 2778), ('CWE-399', 2547), ('CWE-310', 2432), ('CWE-78', 2422), ('CWE-476', 2006), ('CWE-190', 1934), ('CWE-434', 1497), ('CWE-120', 1483), ('CWE-269', 1454), ('CWE-862', 1262), ('CWE-189', 1234), ('CWE-863', 1221), ('CWE-77', 1203), ('CWE-400', 1179), ('CWE-362', 1048), ('CWE-284', 1019), ('CWE-732', 1002), ('CWE-798', 926), ('CWE-59', 900), ('CWE-502', 875), ('CWE-611', 803), ('CWE-295', 797), ('CWE-522', 777), ('CWE-306', 745), ('CWE-918', 733), ('CWE-276', 717), ('CWE-74', 701), ('CWE-255', 697), ('CWE-601', 693), ('CWE-668', 647), ('CWE-770', 508), ('CWE-835', 483), ('CWE-532', 465), ('CWE-401', 459), ('CWE-427', 457), ('CWE-319', 422), ('CWE-254', 395), ('CWE-772', 390), ('CWE-426', 390), ('CWE-415', 374), ('CWE-617', 360), ('CWE-312', 350), ('CWE-327', 336), ('CWE-755', 334), ('CWE-203', 331), ('CWE-639', 305), ('CWE-347', 291), ('CWE-134', 289), ('CWE-843', 279), ('CWE-908', 278), ('CWE-326', 273), ('CWE-129', 253), ('CWE-369', 250), ('CWE-345', 244), ('CWE-16', 242), ('CWE-384', 229), ('CWE-19', 223), ('CWE-209', 222), ('CWE-1321', 220), ('CWE-665', 216), ('CWE-754', 211), ('CWE-1021', 209), ('CWE-613', 206), ('CWE-330', 204), ('CWE-307', 201), ('CWE-704', 199), ('CWE-311', 195), ('CWE-674', 183), ('CWE-346', 182), ('CWE-552', 177), ('CWE-121', 173), ('CWE-404', 171), ('CWE-17', 165), ('CWE-367', 164), ('CWE-191', 159), ('CWE-444', 156), ('CWE-1236', 154), ('CWE-290', 145), ('CWE-122', 142), ('CWE-917', 141), ('CWE-88', 139), ('CWE-281', 135), ('CWE-428', 133), ('CWE-521', 132), ('CWE-1188', 127), ('CWE-824', 124), ('CWE-640', 117), ('CWE-116', 117), ('CWE-610', 116), ('CWE-425', 99), ('CWE-922', 94), ('CWE-667', 93), ('CWE-294', 93), ('CWE-829', 80), ('CWE-285', 79), ('CWE-909', 76), ('CWE-707', 75), ('CWE-459', 75), ('CWE-494', 73), ('CWE-682', 72), ('CWE-91', 72), ('CWE-354', 70), ('CWE-338', 65), ('CWE-193', 65), ('CWE-681', 65), ('CWE-131', 64), ('CWE-252', 64), ('CWE-834', 63), ('CWE-697', 62), ('CWE-275', 60), ('CWE-916', 58), ('CWE-693', 52), ('CWE-763', 50), ('CWE-331', 46), ('CWE-706', 45), ('CWE-670', 43), ('CWE-662', 41), ('CWE-776', 40), ('CWE-93', 39), ('CWE-669', 39), ('CWE-320', 37), ('CWE-788', 36), ('CWE-388', 35), ('CWE-436', 35), ('CWE-212', 34), ('CWE-565', 31), ('CWE-1333', 28), ('CWE-913', 28), ('CWE-113', 22), ('CWE-358', 21), ('CWE-335', 19), ('CWE-672', 19), ('CWE-273', 18), ('CWE-256', 17), ('CWE-266', 17), ('CWE-377', 16), ('CWE-417', 15), ('CWE-123', 15), ('CWE-80', 15), ('CWE-178', 15), ('CWE-23', 15), ('CWE-288', 14), ('CWE-118', 13), ('CWE-185', 13), ('CWE-126', 12), ('CWE-321', 12), ('CWE-822', 12), ('CWE-73', 11), ('CWE-250', 11), ('CWE-470', 11), ('CWE-90', 11), ('CWE-924', 10), ('CWE-749', 10), ('CWE-379', 10), ('CWE-538', 10), ('CWE-297', 10), ('CWE-332', 9), ('CWE-838', 9), ('CWE-184', 9), ('CWE-172', 9), ('CWE-680', 8), ('CWE-789', 8), ('CWE-359', 8), ('CWE-305', 7), ('CWE-361', 7), ('CWE-472', 7), ('CWE-99', 7), ('CWE-61', 7), ('CWE-457', 6), ('CWE-441', 6), ('CWE-170', 6), ('CWE-18', 6), ('CWE-117', 6), ('CWE-201', 6), ('CWE-199', 6), ('CWE-248', 6), ('CWE-799', 6), ('CWE-489', 6), ('CWE-208', 5), ('CWE-1284', 5), ('CWE-548', 5), ('CWE-259', 5), ('CWE-471', 5), ('CWE-322', 5), ('CWE-823', 5), ('CWE-912', 5), ('CWE-840', 4), ('CWE-406', 4), ('CWE-21', 4), ('CWE-95', 3), ('CWE-920', 3), ('CWE-353', 3), ('CWE-1187', 3), ('CWE-300', 3), ('CWE-204', 3), ('CWE-497', 3), ('CWE-130', 3), ('CWE-440', 3), ('CWE-115', 3), ('CWE-805', 3), ('CWE-648', 3), ('CWE-1336', 3), ('CWE-407', 3), ('CWE-1004', 2), ('CWE-112', 2), ('CWE-943', 2), ('CWE-620', 2), ('CWE-303', 2), ('CWE-807', 2), ('CWE-1287', 2), ('CWE-349', 2), ('CWE-1241', 2), ('CWE-1022', 2), ('CWE-453', 2), ('CWE-124', 2), ('CWE-350', 2), ('CWE-1220', 2), ('CWE-240', 2), ('CWE-657', 2), ('CWE-75', 2), ('CWE-318', 2), ('CWE-664', 2), ('CWE-757', 2), ('CWE-405', 2), ('CWE-1274', 2), ('CWE-644', 2), ('CWE-708', 2), ('CWE-214', 2), ('CWE-385', 2), ('CWE-270', 2), ('CWE-549', 2), ('CWE-1', 2), ('CWE-642', 2), ('CWE-603', 2), ('CWE-1286', 2), ('CWE-940', 2), ('CWE-342', 2), ('CWE-279', 2), ('CWE-302', 2), ('CWE-304', 2), ('CWE-280', 2), ('CWE-778', 2), ('CWE-241', 2), ('CWE-769', 2), ('CWE-202', 2), ('CWE-328', 2), ('CWE-534', 2), ('CWE-1258', 2), ('CWE-277', 2), ('CWE-194', 2), ('CWE-391', 1), ('CWE-282', 1), ('CWE-24', 1), ('CWE-460', 1), ('CWE-590', 1), ('CWE-1283', 1), ('CWE-15', 1), ('CWE-274', 1), ('CWE-324', 1), ('CWE-229', 1), ('CWE-267', 1), ('CWE-523', 1), ('CWE-779', 1), ('CWE-506', 1), ('CWE-271', 1), ('CWE-325', 1), ('CWE-141', 1), ('CWE-323', 1), ('CWE-643', 1), ('CWE-1282', 1), ('CWE-540', 1), ('CWE-187', 1), ('CWE-364', 1), ('CWE-671', 1), ('CWE-98', 1), ('CWE-114', 1), ('CWE-941', 1), ('CWE-598', 1), ('CWE-1108', 1), ('CWE-216', 1), ('CWE-759', 1), ('CWE-455', 1), ('CWE-424', 1), ('CWE-456', 1), ('CWE-1320', 1), ('CWE-684', 1), ('CWE-710', 1), ('CWE-334', 1), ('CWE-317', 1), ('CWE-451', 1), ('CWE-911', 1), ('CWE-27', 1), ('CWE-597', 1), ('CWE-146', 1), ('CWE-1026', 1), ('CWE-791', 1), ('CWE-36', 1), ('CWE-649', 1), ('CWE-315', 1), ('CWE-268', 1), ('CWE-1278', 1), ('CWE-507', 1), ('CWE-313', 1), ('CWE-235', 1), ('CWE-242', 1), ('CWE-1390', 1), ('CWE-299', 1), ('CWE-602', 1), ('CWE-64', 1), ('CWE-525', 1), ('CWE-775', 1), ('CWE-573', 1), ('CWE-84', 1), ('CWE-29', 1), ('CWE-257', 1), ('CWE-539', 1), ('CWE-1288', 1), ('CWE-527', 1), ('CWE-1076', 1), ('CWE-195', 1), ('CWE-228', 1), ('CWE-524', 1), ('CWE-1329', 1), ('CWE-378', 1), ('CWE-567', 1), ('CWE-690', 1), ('CWE-371', 1), ('CWE-337', 1), ('CWE-409', 1), ('CWE-833', 1), ('CWE-774', 1), ('CWE-915', 1), ('CWE-895', 1), ('CWE-475', 1), ('CWE-435', 1), ('CWE-923', 1), ('CWE-760', 1)]
350
{'CWE-416', 'CWE-119', 'CWE-20', 'CWE-22', 'CWE-200', 'CWE-264', 'CWE-125', 'CWE-79', 'CWE-787', 'CWE-352', 'CWE-89'}
11
85087
11
['CWE-119', 'CWE-125', 'CWE-20', 'CWE-200', 'CWE-22', 'CWE-264', 'CWE-352', 'CWE-416', 'CWE-787', 'CWE-79', 'CWE-89']
cwe_min_count = 3000


infix+='_'+str(cwe_min_count)

vec_len = 300
min_count = 1
window_len = 5
dense_unit = 256
wv_model_path  = '..//..//models//wv//'+infix+"_"+str(vec_len)+"_"+str(min_count)+"_"+str(window_len)+'.pkl'
label_path = '..\\..\\data\\clean\\nvdcve-1.1-'+infix+'_labels.csv'
n=30

cwe_count = 11
2128/2128 [==============================] - 125s 55ms/step - loss: 0.6640 - accuracy: 0.7737
2023-03-04 11:16:05.557930: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 4900968000 exceeds 10% of free system memory.
Epoch 2/10
2128/2128 [==============================] - 116s 55ms/step - loss: 0.3762 - accuracy: 0.8751
2023-03-04 11:18:03.090010: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 4900968000 exceeds 10% of free system memory.
Epoch 3/10
2128/2128 [==============================] - 116s 55ms/step - loss: 0.3329 - accuracy: 0.8897
Epoch 4/10
2128/2128 [==============================] - 116s 55ms/step - loss: 0.3035 - accuracy: 0.8977
Epoch 5/10
2128/2128 [==============================] - 117s 55ms/step - loss: 0.2789 - accuracy: 0.9054
Epoch 6/10
2128/2128 [==============================] - 117s 55ms/step - loss: 0.2631 - accuracy: 0.9096
Epoch 7/10
2128/2128 [==============================] - 117s 55ms/step - loss: 0.2442 - accuracy: 0.9165
Epoch 8/10
2128/2128 [==============================] - 116s 55ms/step - loss: 0.2402 - accuracy: 0.9188
Epoch 9/10
2128/2128 [==============================] - 117s 55ms/step - loss: 0.2300 - accuracy: 0.9227
Epoch 10/10
2128/2128 [==============================] - 116s 55ms/step - loss: 0.2237 - accuracy: 0.9245
532/532 [==============================] - 5s 8ms/step - loss: 0.4008 - accuracy: 0.8844
last score: [0.4008321166038513, 0.8844165205955505]
Model: "sequential"










